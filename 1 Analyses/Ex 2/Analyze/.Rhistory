temp = t.test(post.IS.jol$U, post.IS.r$U, paired = T, p.adjust.methods = "bonferroni", var.equal = T)
temp
round(temp$p.value, 3)
temp$statistic
(temp$conf.int[2] - temp$conf.int[1]) / 3.92
#RL
temp = t.test(post.RL.jol$U, post.RL.r$U, paired = T, p.adjust.methods = "bonferroni", var.equal = T)
temp
round(temp$p.value, 3)
temp$statistic
(temp$conf.int[2] - temp$conf.int[1]) / 3.92
#get ds
mean(post.READ.jol$U); mean(post.READ.r$U)
sd(post.READ.jol$U); sd(post.READ.r$U)
mean(post.IS.jol$U); mean(post.IS.r$U)
sd(post.IS.jol$U); sd(post.IS.r$U)
#PBIC
pbic1 = post.RL.jol[ , c(1,5)]
pbic2 = post.RL.r[ , c(1,5)]
pbic1$task = rep("jol")
pbic2$task = rep("recall")
pbic3 = rbind(pbic1, pbic2)
ezANOVA(pbic3,
dv = U,
wid = Sub.ID,
within = task,
type = 3,
detailed = T)
####Get 95% CIs####
###JOL
##IS
x = apply(post.IS.jol, 2, sd)
x / sqrt(length(unique(post.IS.jol$Sub.ID))) * 1.96
##RL
x = apply(post.RL.jol, 2, sd)
x / sqrt(length(unique(post.RL.jol$Sub.ID))) * 1.96
##READ
x = apply(post.READ.jol, 2, sd)
x / sqrt(length(unique(post.READ.jol$Sub.ID))) * 1.96
###Recall
##IS
x = apply(post.IS.r, 2, sd)
x / sqrt(length(unique(post.IS.r$Sub.ID))) * 1.96
##RL
x = apply(post.RL.r, 2, sd)
x / sqrt(length(unique(post.RL.r$Sub.ID))) * 1.96
##READ
x = apply(post.READ.r, 2, sd)
x / sqrt(length(unique(post.READ.r$Sub.ID))) * 1.96
####get values for cohen's d####
###JOL
##IS
apply(post.IS.jol, 2, mean)
apply(post.IS.jol, 2, sd)
##RL
apply(post.RL.jol, 2, mean)
apply(post.RL.jol, 2, sd)
##READ
apply(post.READ.jol, 2, mean)
apply(post.READ.jol, 2, sd)
###RECALL
##IS
apply(post.IS.r, 2, mean)
apply(post.IS.r, 2, sd)
##RL
apply(post.RL.r, 2, mean)
apply(post.RL.r, 2, sd)
##READ
apply(post.READ.r, 2, mean)
apply(post.READ.r, 2, sd)
####Gamma####
##get data in the right format
long.dat.r = subset(long.dat,
long.dat$measure == "Recall")
long.dat.j = subset(long.dat,
long.dat$measure == "JOL")
combined = cbind(long.dat.r, long.dat.j)
combined_gammas = combined[ , -c(5, 7:11)]
colnames(combined_gammas)[5] = "Recall"
colnames(combined_gammas)[6] = "JOL"
colnames(combined_gammas)[2] = "type"
colnames(combined_gammas)[1] = "Subject"
combined_gammas = combined_gammas[ , c(1:4, 6, 5)]
combined_gammas$Recall[combined_gammas$Recall == 100] = 1
##Subset by encoding task
gammas_IS = subset(combined_gammas,
combined_gammas$type == "IS")
gammas_RL = subset(combined_gammas,
combined_gammas$type == "RL")
gammas_READ = subset(combined_gammas,
combined_gammas$type == "READ")
##Okay, now subset everything by direction
##IS
gammas_IS_F = subset(gammas_IS,
gammas_IS$Direction == "F")
gammas_IS_B = subset(gammas_IS,
gammas_IS$Direction == "B")
gammas_IS_S = subset(gammas_IS,
gammas_IS$Direction == "S")
gammas_IS_U = subset(gammas_IS,
gammas_IS$Direction == "U")
##RL
gammas_RL_F = subset(gammas_RL,
gammas_RL$Direction == "F")
gammas_RL_B = subset(gammas_RL,
gammas_RL$Direction == "B")
gammas_RL_S = subset(gammas_RL,
gammas_RL$Direction == "S")
gammas_RL_U = subset(gammas_RL,
gammas_RL$Direction == "U")
##READ
gammas_READ_F = subset(gammas_READ,
gammas_READ$Direction == "F")
gammas_READ_B = subset(gammas_READ,
gammas_READ$Direction == "B")
gammas_READ_S = subset(gammas_READ,
gammas_READ$Direction == "S")
gammas_READ_U = subset(gammas_READ,
gammas_READ$Direction == "U")
###Now do a bunch of loops to get mean gammas (computes gamma for each participant then averages)
##Start with IS
#F
empty = data.frame()
for (i in unique(gammas_IS_F$Subject)){
temp = subset(gammas_IS_F, gammas_IS_F$Subject == i)
g = rcorr.cens(temp$Recall, temp$JOL, outx = TRUE)[2]
g = unname(g)
temp2 = data.frame(i, g)
empty = rbind(temp2, empty)
}
forward_IS = empty
#Backward IS
empty = data.frame()
for (i in unique(gammas_IS_B$Subject)){
temp = subset(gammas_IS_B, gammas_IS_B$Subject == i)
g = rcorr.cens(temp$Recall, temp$JOL, outx = TRUE)[2]
g = unname(g)
temp2 = data.frame(i, g)
empty = rbind(temp2, empty)
}
backward_IS = empty
#Symmetrical IS
empty = data.frame()
for (i in unique(gammas_IS_S$Subject)){
temp = subset(gammas_IS_S, gammas_IS_B$Subject == i)
g = rcorr.cens(temp$Recall, temp$JOL, outx = TRUE)[2]
g = unname(g)
temp2 = data.frame(i, g)
empty = rbind(temp2, empty)
}
symmetrical_IS = empty
#Unrelated IS
empty = data.frame()
for (i in unique(gammas_IS_U$Subject)){
temp = subset(gammas_IS_U, gammas_IS_U$Subject == i)
g = rcorr.cens(temp$Recall, temp$JOL, outx = TRUE)[2]
g = unname(g)
temp2 = data.frame(i, g)
empty = rbind(temp2, empty)
}
Unrelated_IS = empty
##Now do relational
#F
empty = data.frame()
for (i in unique(gammas_RL_F$Subject)){
temp = subset(gammas_RL_F, gammas_RL_F$Subject == i)
g = rcorr.cens(temp$Recall, temp$JOL, outx = TRUE)[2]
g = unname(g)
temp2 = data.frame(i, g)
empty = rbind(temp2, empty)
}
forward_RL = empty
#Backward
empty = data.frame()
for (i in unique(gammas_RL_B$Subject)){
temp = subset(gammas_RL_B, gammas_RL_B$Subject == i)
g = rcorr.cens(temp$Recall, temp$JOL, outx = TRUE)[2]
g = unname(g)
temp2 = data.frame(i, g)
empty = rbind(temp2, empty)
}
backward_RL = empty
#Symmetrical
empty = data.frame()
for (i in unique(gammas_RL_S$Subject)){
temp = subset(gammas_RL_S, gammas_RL_B$Subject == i)
g = rcorr.cens(temp$Recall, temp$JOL, outx = TRUE)[2]
g = unname(g)
temp2 = data.frame(i, g)
empty = rbind(temp2, empty)
}
symmetrical_RL = empty
#Unrelated
empty = data.frame()
for (i in unique(gammas_RL_U$Subject)){
temp = subset(gammas_RL_U, gammas_RL_U$Subject == i)
g = rcorr.cens(temp$Recall, temp$JOL, outx = TRUE)[2]
g = unname(g)
temp2 = data.frame(i, g)
empty = rbind(temp2, empty)
}
Unrelated_RL = empty
##Now do read
#F
empty = data.frame()
for (i in unique(gammas_READ_F$Subject)){
temp = subset(gammas_READ_F, gammas_READ_F$Subject == i)
g = rcorr.cens(temp$Recall, temp$JOL, outx = TRUE)[2]
g = unname(g)
temp2 = data.frame(i, g)
empty = rbind(temp2, empty)
}
forward_READ = empty
#Backward
empty = data.frame()
for (i in unique(gammas_READ_B$Subject)){
temp = subset(gammas_READ_B, gammas_READ_B$Subject == i)
g = rcorr.cens(temp$Recall, temp$JOL, outx = TRUE)[2]
g = unname(g)
temp2 = data.frame(i, g)
empty = rbind(temp2, empty)
}
backward_READ = empty
#Symmetrical
empty = data.frame()
for (i in unique(gammas_READ_S$Subject)){
temp = subset(gammas_READ_S, gammas_READ_B$Subject == i)
g = rcorr.cens(temp$Recall, temp$JOL, outx = TRUE)[2]
g = unname(g)
temp2 = data.frame(i, g)
empty = rbind(temp2, empty)
}
symmetrical_READ = empty
#Unrelated
empty = data.frame()
for (i in unique(gammas_READ_U$Subject)){
temp = subset(gammas_READ_U, gammas_READ_U$Subject == i)
g = rcorr.cens(temp$Recall, temp$JOL, outx = TRUE)[2]
g = unname(g)
temp2 = data.frame(i, g)
empty = rbind(temp2, empty)
}
Unrelated_READ = empty
##Okay, get means!
#IS
mean(forward_IS$g, na.rm = T)
mean(backward_IS$g, na.rm = T)
mean(symmetrical_IS$g, na.rm = T)
mean(Unrelated_IS$g, na.rm = T)
#RL
mean(forward_RL$g, na.rm = T)
mean(backward_RL$g, na.rm = T)
mean(symmetrical_RL$g, na.rm = T)
mean(Unrelated_RL$g, na.rm = T)
#READ
mean(forward_READ$g, na.rm = T)
mean(backward_READ$g, na.rm = T)
mean(symmetrical_READ$g, na.rm = T)
mean(Unrelated_READ$g, na.rm = T)
##Do the one way t-test
#read
t.test(forward_READ$g)
t.test(backward_READ$g) #non-sig
t.test(symmetrical_READ$g)
t.test(Unrelated_READ$g)
#IS
t.test(forward_IS$g) #non-sig
t.test(backward_IS$g) #non-sig
t.test(symmetrical_IS$g)
t.test(Unrelated_IS$g)
#RL
t.test(forward_RL$g) #non-sig
t.test(backward_RL$g) #non-sig
t.test(symmetrical_RL$g) #non-sig
t.test(Unrelated_RL$g) #non-sig
##GET CIs for table
(sd(forward_RL$g, na.rm = T) / sqrt(nrow(forward_RL))) * 1.96
(sd(forward_READ$g, na.rm = T) / sqrt(nrow(forward_READ))) * 1.96
(sd(forward_IS$g, na.rm = T) / sqrt(nrow(forward_IS))) * 1.96
(sd(backward_RL$g, na.rm = T) / sqrt(nrow(backward_RL))) * 1.96
(sd(backward_READ$g, na.rm = T) / sqrt(nrow(backward_READ))) * 1.96
(sd(backward_IS$g, na.rm = T) / sqrt(nrow(backward_IS))) * 1.96
(sd(symmetrical_RL$g, na.rm = T) / sqrt(nrow(symmetrical_RL))) * 1.96
(sd(symmetrical_READ$g, na.rm = T) / sqrt(nrow(symmetrical_READ))) * 1.96
(sd(symmetrical_IS$g, na.rm = T) / sqrt(nrow(symmetrical_IS))) * 1.96
(sd(Unrelated_RL$g, na.rm = T) / sqrt(nrow(Unrelated_RL))) * 1.96
(sd(Unrelated_READ$g, na.rm = T) / sqrt(nrow(Unrelated_READ))) * 1.96
(sd(Unrelated_IS$g, na.rm = T) / sqrt(nrow(Unrelated_IS))) * 1.96
##ANOVA and T-TESTS
##Now combine
gamma_ANOVA = rbind(forward_IS, forward_READ, forward_RL,
backward_IS, backward_READ, backward_RL,
symmetrical_IS, symmetrical_READ, symmetrical_RL,
Unrelated_IS, Unrelated_READ, Unrelated_RL)
#get rid of nan's
is.nan.data.frame <- function(x)
do.call(cbind, lapply(x, is.nan))
gamma_ANOVA[is.nan(gamma_ANOVA)] <- 0
gamma_ANOVA$i = as.character(gamma_ANOVA$i)
##Okay, anova time!
output_gamma = ezANOVA(gamma_ANOVA,
within = direction,
between = group,
wid = i,
dv = g,
type = 3,
detailed = T)
View(gamma_ANOVA)
##IS
forward_IS$group = rep("IS")
forward_IS$direction = rep("F")
backward_IS$group = rep("IS")
backward_IS$direction = rep("B")
symmetrical_IS$group = rep("IS")
symmetrical_IS$direction = rep("S")
Unrelated_IS$group = rep("IS")
Unrelated_IS$direction = rep("U")
##rl
forward_RL$group = rep("RL")
forward_RL$direction = rep("F")
backward_RL$group = rep("RL")
backward_RL$direction = rep("B")
symmetrical_RL$group = rep("RL")
symmetrical_RL$direction = rep("S")
Unrelated_RL$group = rep("RL")
Unrelated_RL$direction = rep("U")
##read
forward_READ$group = rep("READ")
forward_READ$direction = rep("F")
backward_READ$group = rep("READ")
backward_READ$direction = rep("B")
symmetrical_READ$group = rep("READ")
symmetrical_READ$direction = rep("S")
Unrelated_READ$group = rep("READ")
Unrelated_READ$direction = rep("U")
##Now combine
gamma_ANOVA = rbind(forward_IS, forward_READ, forward_RL,
backward_IS, backward_READ, backward_RL,
symmetrical_IS, symmetrical_READ, symmetrical_RL,
Unrelated_IS, Unrelated_READ, Unrelated_RL)
#get rid of nan's
is.nan.data.frame <- function(x)
do.call(cbind, lapply(x, is.nan))
gamma_ANOVA[is.nan(gamma_ANOVA)] <- 0
gamma_ANOVA$i = as.character(gamma_ANOVA$i)
##Okay, anova time!
output_gamma = ezANOVA(gamma_ANOVA,
within = direction,
between = group,
wid = i,
dv = g,
type = 3,
detailed = T)
output_gamma$ANOVA$MSE = output_gamma$ANOVA$SSd/output_gamma$ANOVA$DFd
output_gamma$ANOVA$MSE
aovEffectSize(output_gamma, effectSize = "pes")
aovEffectSize(output_gamma, effectSize = "pes")
tapply(gamma_ANOVA$g, gamma_ANOVA$group, mean)
tapply(gamma_ANOVA$g, gamma_ANOVA$direction, mean)
tapply(gamma_ANOVA$g, list(gamma_ANOVA$group, gamma_ANOVA$direction), mean) #interaction
tapply(gamma_ANOVA$g, gamma_ANOVA$direction, mean)
tapply(gamma_ANOVA$g, gamma_ANOVA$group, mean)
aovEffectSize(output_gamma, effectSize = "pes")
head(gamma_ANOVA)
#break down effect of group
group1 = cast(gamma_ANOVA[ , c(1,3,4,2)], i ~ group, mean)
head(group1)
temp = t.test(group1$READ, group1$IS, paired = F, var.equal = T, p.adjust.methods = "Bonferroni")
p1 = round(temp$p.value, 3)
t1 = temp$statistic
SEM1 = (temp$conf.int[2] - temp$conf.int[1]) / 3.92
temp
temp = t.test(group1$RL, group1$IS, paired = F, var.equal = T, p.adjust.methods = "Bonferroni")
p1 = round(temp$p.value, 3)
t1 = temp$statistic
SEM1 = (temp$conf.int[2] - temp$conf.int[1]) / 3.92
temp
temp = t.test(group1$READ, group1$RL, paired = F, var.equal = T, p.adjust.methods = "Bonferroni")
p1 = round(temp$p.value, 3)
t1 = temp$statistic
SEM1 = (temp$conf.int[2] - temp$conf.int[1]) / 3.92
temp
temp
SEM1
temp = t.test(group1$RL, group1$IS, paired = F, var.equal = T, p.adjust.methods = "Bonferroni")
p1 = round(temp$p.value, 3)
t1 = temp$statistic
SEM1 = (temp$conf.int[2] - temp$conf.int[1]) / 3.92
temp
head(group1)
pbic1 = group1[ c(1, 2)]
pbic2 = group1[ c, 1, 4]
pbic1 = group1[ ,c(1, 2)]
pbic2 = group1[ ,c( 1, 4)]
colnames(pbic1)[2] = "score"
colnames(pbic2)[2] = "score"
pbic1$task = rep("IS")
pbic2$task = rep("RL")
pbic3 = rbind(pbic1, pbic2)
pbic3 = na.omit(pbic3)
ezANOVA(pbic3,
dv = score,
wid = i,
between = task,
detailed = T)
sd(group1$READ, na.rm = T); sd(group1$RL; na.rm = T)
sd(group1$READ, na.rm = T); sd(group1$R, na.rm = T)
sd(group1$READ, na.rm = T); sd(group1$RL, na.rm = T)
temp = t.test(group1$READ, group1$RL, paired = F, var.equal = T, p.adjust.methods = "Bonferroni")
p1 = round(temp$p.value, 3)
t1 = temp$statistic
SEM1 = (temp$conf.int[2] - temp$conf.int[1]) / 3.92
temp
sd(group1$READ, na.rm = T); sd(group1$RL, na.rm = T)
##effect of pair type
group2 = cast(gamma_ANOVA[ , c(1,3,4,2)], i ~ direction, mean)
temp = t.test(group2$F, group2$B, paired = F, var.equal = T, p.adjust.methods = "Bonferroni")
p1 = round(temp$p.value, 3)
t1 = temp$statistic
SEM1 = (temp$conf.int[2] - temp$conf.int[1]) / 3.92
temp
temp = t.test(group2$F, group2$S, paired = F, var.equal = T, p.adjust.methods = "Bonferroni")
p1 = round(temp$p.value, 3)
t1 = temp$statistic
SEM1 = (temp$conf.int[2] - temp$conf.int[1]) / 3.92
temp
temp = t.test(group2$F, group2$S, paired = F, var.equal = T, p.adjust.methods = "Bonferroni")
p1 = round(temp$p.value, 3)
t1 = temp$statistic
SEM1 = (temp$conf.int[2] - temp$conf.int[1]) / 3.92
temp
temp = t.test(group2$F, group2$U, paired = F, var.equal = T, p.adjust.methods = "Bonferroni")
p1 = round(temp$p.value, 3)
t1 = temp$statistic
SEM1 = (temp$conf.int[2] - temp$conf.int[1]) / 3.92
temp
#b
temp = t.test(group2$B, group2$S, paired = F, var.equal = T, p.adjust.methods = "Bonferroni")
p1 = round(temp$p.value, 3)
t1 = temp$statistic
SEM1 = (temp$conf.int[2] - temp$conf.int[1]) / 3.92
temp
temp = t.test(group2$B, group2$U, paired = F, var.equal = T, p.adjust.methods = "Bonferroni")
p1 = round(temp$p.value, 3)
t1 = temp$statistic
SEM1 = (temp$conf.int[2] - temp$conf.int[1]) / 3.92
temp
#S
temp = t.test(group2$U, group2$S, paired = F, var.equal = T, p.adjust.methods = "Bonferroni")
p1 = round(temp$p.value, 3)
t1 = temp$statistic
SEM1 = (temp$conf.int[2] - temp$conf.int[1]) / 3.92
temp
#b
temp = t.test(group2$B, group2$S, paired = F, var.equal = T, p.adjust.methods = "Bonferroni")
p1 = round(temp$p.value, 3)
t1 = temp$statistic
SEM1 = (temp$conf.int[2] - temp$conf.int[1]) / 3.92
temp
temp = t.test(group2$B, group2$U, paired = F, var.equal = T, p.adjust.methods = "Bonferroni")
p1 = round(temp$p.value, 3)
t1 = temp$statistic
SEM1 = (temp$conf.int[2] - temp$conf.int[1]) / 3.92
temp
#S
temp = t.test(group2$U, group2$S, paired = F, var.equal = T, p.adjust.methods = "Bonferroni")
p1 = round(temp$p.value, 3)
t1 = temp$statistic
SEM1 = (temp$conf.int[2] - temp$conf.int[1]) / 3.92
temp
temp = t.test(group2$B, group2$U, paired = F, var.equal = T, p.adjust.methods = "Bonferroni")
p1 = round(temp$p.value, 3)
t1 = temp$statistic
SEM1 = (temp$conf.int[2] - temp$conf.int[1]) / 3.92
temp
sd(group2$S)
sd(group2$B)
#f
temp = t.test(group2$F, group2$B, paired = F, var.equal = T, p.adjust.methods = "Bonferroni")
p1 = round(temp$p.value, 3)
t1 = temp$statistic
SEM1 = (temp$conf.int[2] - temp$conf.int[1]) / 3.92
temp
pbic1 = group2[ , c(1, 3)]
pbic2 = group2[ , c(1, 2)]
colnames(pbic1)[2] = "directin"
colnames(pbic1)[2] = "direction"
colnames(pbic2)[2] = "direction"
pbic1$thing = rep("F")
pbic2$thikng = rep("B")
pbic3 = rbind(pbic1, pbic2)
pbic1 = group2[ , c(1, 3)]
pbic2 = group2[ , c(1, 2)]
colnames(pbic1)[2] = "direction"
colnames(pbic2)[2] = "direction"
pbic1$thing = rep("F")
pbic2$thing = rep("B")
pbic3 = rbind(pbic1, pbic2)
ezANOVA(pbic3,
wid = i
dv = direction,
head(pbic3)
ezANOVA(pbic3,
wid = i,
dv = direction,
between = thing,
detailed = T)
ezANOVA(pbic3,
wid = i,
dv = direction,
within = thing,
detailed = T)
